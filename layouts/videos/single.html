{{ define "main" }}
  <style>
    :root{
      --max-width:1100px;
      --gap:1.25rem;
      --card-radius:12px;
      --muted:#6b7280;
      --bg:#fff;
      --surface-shadow: 0 8px 24px rgba(11,22,39,0.06);
      --accent-start: #1e3a8a; /* deep blue */
      --accent-end: #3b82f6;   /* bright blue */
      --accent: linear-gradient(90deg,var(--accent-start),var(--accent-end));
      --transition: 220ms cubic-bezier(.2,.9,.2,1);
    }

    .video-page { max-width:var(--max-width); margin:1.75rem auto; padding:0 1rem; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color:#0f172a; }
    .video-header { display:flex; flex-direction:column; gap:.25rem; margin-bottom:1rem; }
    .video-header h1 { margin:0; font-size:clamp(1.4rem, 2.4vw, 2rem); letter-spacing:-0.01em; }
    .video-header .meta { color:var(--muted); font-size:0.95rem; }

    .video-wrap { position:relative; width:100%; padding-bottom:56.25%; height:0; overflow:hidden; border-radius:12px; background:#000; box-shadow: var(--surface-shadow); margin-top:0.75rem; }
    .video-wrap iframe { position:absolute; inset:0; width:100%; height:100%; border:0; }

    .actions { display:flex; gap:.6rem; margin-top:.75rem; align-items:center; flex-wrap:wrap; }
    .btn {
      display:inline-flex; align-items:center; gap:.5rem; padding:.45rem .75rem; border-radius:8px; text-decoration:none;
      background: var(--accent-start); color:#fff; font-weight:600; box-shadow: 0 8px 20px rgba(59,130,246,0.08);
    }
    .btn.ghost { background:transparent; color:var(--accent-start); border:1px solid rgba(59,130,246,0.12); box-shadow:none; font-weight:600; }

    .content { margin-top:1rem; color:#334155; line-height:1.65; background:var(--bg); padding:1rem; border-radius:10px; box-shadow:0 6px 18px rgba(11,22,39,0.04); }

    /* related grid (small cards to match list) */
    .related { margin-top:1.25rem; }
    .related-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap:var(--gap); margin-top:.75rem; }
    .rel-card { display:flex; gap:.6rem; align-items:center; background:var(--bg); padding:.5rem; border-radius:10px; box-shadow:0 6px 16px rgba(11,22,39,0.04); }
    .rel-thumb { width:120px; height:68px; flex-shrink:0; overflow:hidden; border-radius:6px; background:#000; }
    .rel-thumb img { width:100%; height:100%; object-fit:cover; display:block; }

    @media (max-width:620px){ .rel-thumb { width:96px;height:54px } .btn { padding:.4rem .6rem } }
  </style>

  {{/* JSON-LD VideoObject for the video (if youtube_id present) */}}
  {{ $id := .Params.youtube_id }}
  {{ if $id }}
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "VideoObject",
    "name": {{ .Title | jsonify }},
    "description": {{ (or .Params.description .Summary .Params.excerpt) | default .Summary | jsonify }},
    "thumbnailUrl": "https://i.ytimg.com/vi/{{ $id }}/hqdefault.jpg",
    "uploadDate": "{{ .Date.Format "2006-01-02" }}",
    "contentUrl": "https://www.youtube.com/watch?v={{ $id }}",
    "embedUrl": "https://www.youtube-nocookie.com/embed/{{ $id }}",
    "publisher": {
      "@type": "Organization",
      "name": {{ .Site.Title | jsonify }},
      "url": {{ .Site.BaseURL | jsonify }}
    }
  }
  </script>
  {{ end }}

  <div class="video-page">
    <header class="video-header">
      <h1>{{ .Title }}</h1>
      <div class="meta">{{ .Date.Format "Jan 2, 2006" }} • {{ .Params.duration | default "" }}</div>
    </header>

    {{ if $id }}
      <div class="video-wrap" aria-label="Video: {{ .Title }}">
        <iframe src="https://www.youtube-nocookie.com/embed/{{ $id }}" title="{{ .Title }}" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe>
      </div>
    {{ else }}
      <div style="padding:.75rem;background:#fff;border-radius:10px;border:1px solid rgba(15,23,42,0.04);">
        <p style="margin:0;color:var(--muted)">No YouTube ID set for this page.</p>
      </div>
    {{ end }}

    <div class="actions">
      {{ if $id }}
        <a class="btn" href="https://www.youtube.com/watch?v={{ $id }}" target="_blank" rel="noopener">Watch on YouTube</a>
      {{ end }}
      <a class="btn ghost" href="{{ .Site.BaseURL }}videos/">← Back to videos</a>
    </div>

    <article class="content">
      {{ .Content }}
    </article>

    {{/* Related: show up to 4 other videos (same section) */}}
    {{ $related := where .Site.RegularPages "Section" "videos" }}
    {{ if $related }}
      {{ $others := where $related "File.Path" "ne" .File.Path | first 4 }}
      {{ if gt (len $others) 0 }}
        <section class="related" aria-label="Related videos">
          <h3>More videos</h3>
          <div class="related-grid">
            {{ range $others }}
              {{ $rid := .Params.youtube_id }}
              <a class="rel-card" href="{{ .RelPermalink }}">
                <div class="rel-thumb">
                  {{ if $rid }}
                    <img src="https://i.ytimg.com/vi/{{ $rid }}/hqdefault.jpg" alt="{{ .Title }} thumbnail" loading="lazy" />
                  {{ else }}
                    <img src="/images/placeholder-video.jpg" alt="{{ .Title }} thumbnail" loading="lazy" />
                  {{ end }}
                </div>
                <div>
                  <div style="font-weight:600;color:#071233">{{ .Title }}</div>
                  <div style="font-size:.85rem;color:var(--muted)">{{ .Date.Format "Jan 2, 2006" }}</div>
                </div>
              </a>
            {{ end }}
          </div>
        </section>
      {{ end }}
    {{ end }}
  </div>
{{ end }}
